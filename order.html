<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Julia Mooncake – Order Online</title>

  <link href="https://fonts.googleapis.com/css2?family=Karla:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    /* =========================================
       GLOBAL & UTILITY STYLES
       ========================================= */

    body {
      margin: 0;
      font-family: 'Karla', sans-serif;
      background-color: #ffffff;
      color: #1c1322;
    }

    .page-wrapper {
      width: 1440px;
      margin: 0 auto;
      min-height: 100vh;
      background-color: #ffffff;
      display: flex;
      flex-direction: column;
    }

    .content-container {
      width: 1200px;
      margin: 0 auto;
      padding: 0;
    }

    h1, h2, h3 {
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
      letter-spacing: 0.03em;
    }
    
    .form-section h3 {
        color: #000000;
    }

    a {
      color: #1c1322;
      text-decoration: none;
    }

    a:hover,
    a:focus {
      text-decoration: underline;
    }

    .cta-button {
      background-color: #FFBA51;
      color: #000000;
      border: none;
      padding: 15px 52px;
      border-radius: 999px;
      font-family: 'Quicksand', sans-serif;
      font-weight: 700;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      cursor: pointer;
      margin-top: 8px;
      display: inline-block; 
      text-decoration: none; 
      transition: background-color 0.2s;
    }

    .cta-button:hover {
      filter: brightness(1.08);
      text-decoration: none;
    }
    
    /* =========================================
       HEADER STYLES
       ========================================= */

    .site-header {
      background-color: #f4e7ff;
      padding-top: 12px;     
      padding-bottom: 16px; 
      position: relative; 
    }

    .header-inner {
      position: relative;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .nav-left,
    .nav-right {
      display: flex;
      padding-top: 25px;
      padding-bottom: 25px;
      align-items: center;
      gap: 48px;
      text-transform: uppercase;
      font-size: 20px;
      letter-spacing: 0.18em;
      font-family: 'Quicksand', sans-serif;
      font-weight: 600;
      height: 100%;
    }

    .active {
      text-decoration: none; 
    }

    .logo-wrapper {
      position: absolute;
      left: 50%;
      top: 55%;
      transform: translate(-50%, -50%);
      width: 130px;
      height: 130px;
      border-radius: 50%;
      background-color: #ffffff;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 10;
    }

    .logo-wrapper a {
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      text-decoration: none;
    }

    .logo-wrapper img {
      max-width: 70%;
      height: auto;
      transition: transform 3s ease;
    }

    .logo-wrapper:hover img {
      transform: rotate(360deg);
    }
    
    /* =========================================
       FOOTER STYLES
       ========================================= */

    .site-footer {
      background-color: #f4e7ff;
      padding: 40px 0 40px;
      font-family: 'Karla', sans-serif;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #241728;
      border-top: 2px solid #e4d3f4;
      margin-top: auto;
    }

    .footer-inner {
      display: flex;
      justify-content: space-between;
      gap: 64px;
      align-items: flex-start;
    }

    .footer-column {
      flex: 1;
    }

    .footer-heading {
      font-size: 16px;
      font-weight: 700;
      letter-spacing: 0.18em;
      margin: 0 0 20px;
      opacity: 0.75;
    }

    .footer-nav a,
    .footer-policy a,
    .footer-contact-item {
      display: flex;
      align-items: flex-start;
      gap: 12px;
      font-size: 13px;
      line-height: 2.4;
      margin-bottom: 6px;
      font-family: 'Karla', sans-serif; 
    }

    .icon {
      width: 22px;
      height: 22px;
      flex-shrink: 0;
      margin-top: 4px;
    }

    .site-footer a:link {
      color: #241728;
    }

    .site-footer a:visited {
      color: #3b2b4a;
    }

    .site-footer a:hover {
      text-decoration: underline;
    }

    .site-footer a:active {
      opacity: 0.7;
    }

    /* =========================================
       ORDER PAGE SPECIFIC STYLES
       ========================================= */

    .order-grid {
        display: grid;
        grid-template-columns: 3.6fr 1.4fr; 
        gap: 60px;
        padding-top: 40px;
        padding-bottom: 80px;
        align-items: start; 
    }

    .order-title {
        grid-column: 1 / span 2; 
        font-family: 'Quicksand', sans-serif;
        font-size: 28px;
        font-weight: 700;
        letter-spacing: 0.20em;
        text-transform: uppercase;
        margin-bottom: 30px;
        text-align: center;
        border-bottom: 1px solid #e4d3f4;
        padding-bottom: 15px;
    }

    .order-form-column {
        grid-column: 1 / 2;
        width: 100%; 
    }
    
    .form-section {
        margin-bottom: 40px;
    }

    .form-section h3 {
        font-size: 16px;
        font-weight: 700;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        margin-bottom: 15px;
        color: #000000; 
    }

    /* Box Size Dropdown */
    select.box-size-select {
        width: 100%;
        padding: 10px;
        border: 1px solid #d3b9e8;
        border-radius: 6px;
        font-size: 16px;
        font-family: 'Karla', sans-serif;
        background-color: #f9f7fc;
        color: #1c1322; 
    }

    /* Flavor Options Grid */
    .flavor-options {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 15px;
    }

    .flavor-option {
        text-align: center;
        cursor: pointer;
    }
    
    .flavor-option input[type="checkbox"] {
        display: none;
    }
    
    .flavor-image-wrapper {
        border: 3px solid transparent;
        border-radius: 8px;
        overflow: hidden;
        margin-bottom: 5px;
        transition: border-color 0.2s;
        padding: 3px;

        /* NEW: make all highlight boxes the same size */
        height: 260px;                 /* adjust this value to match your tallest card */
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: #ffffff;
    }

    .flavor-option input[type="checkbox"]:checked + .flavor-image-wrapper {
        border-color: #f4e7ff; 
        box-shadow: 0 0 0 2px #d3b9e8;
    }

    .flavor-option img {
        max-width: 100%;
        max-height: 100%;
        height: auto;
        width: auto;
        display: block;
        border-radius: 5px;
    }

    .flavor-option p {
        font-size: 14px;
        margin: 0;
        font-weight: 600;
        font-family: 'Karla', sans-serif; 
    }

    /* Notes Textarea */
    textarea[name="notes"] {
        width: 100%;
        min-height: 80px;
        padding: 12px;
        border: 1px solid #d3b9e8;
        border-radius: 6px;
        box-sizing: border-box;
        font-family: 'Karla', sans-serif;
        font-size: 16px;
        background-color: #f9f7fc;
        resize: vertical;
        color: #1c1322; 
    }

    /* Pickup/Delivery Radio Buttons */
    .delivery-options label {
        display: block;
        font-size: 16px;
        margin-bottom: 15px;
        font-family: 'Karla', sans-serif; 
    }
    .delivery-options input[type="radio"] {
        margin-right: 8px;
        transform: scale(1.2); 
    }

    /* Delivery Fields (Initially hidden) */
    .delivery-details {
        display: none; 
        margin-top: 25px;
        margin-bottom: 30px;
    }

    .delivery-details .input-group {
        display: flex;
        gap: 20px;
        margin-bottom: 20px;
    }
    .delivery-details .input-group > div {
        flex: 1;
    }
    .delivery-details input {
        width: 100%;
        padding: 10px;
        border: 1px solid #d3b9e8;
        border-radius: 6px;
        box-sizing: border-box;
        font-family: 'Karla', sans-serif;
        font-size: 16px;
        background-color: #f9f7fc;
        color: #1c1322; 
    }
    .delivery-details label { 
        display: none; 
    }


    .date-time-inputs { 
        display: flex;
        gap: 20px;
        margin-top: 15px;
        margin-bottom: 30px;
    }

    .date-time-inputs div {
        flex: 1;
    }

    .date-time-inputs input {
        width: 100%;
        padding: 10px;
        border: 1px solid #d3b9e8;
        border-radius: 6px;
        box-sizing: border-box;
        font-family: 'Karla', sans-serif;
        font-size: 16px;
        background-color: #f9f7fc;
        color: #1c1322; 
    }
    .date-time-inputs label {
        display: block;
        font-size: 12px;
        text-transform: uppercase;
        margin-bottom: 5px;
        font-family: 'Karla', sans-serif; 
    }

    /* Your Details (Name, Phone, Email) */
    .your-details-group {
        display: flex;
        gap: 20px;
        margin-bottom: 25px;
    }
    .your-details-group > div {
        flex: 1;
    }

    .your-details-group input {
        width: 100%;
        padding: 10px;
        border: 1px solid #d3b9e8;
        border-radius: 6px;
        box-sizing: border-box;
        font-family: 'Karla', sans-serif;
        font-size: 16px;
        background-color: #f9f7fc;
        color: #1c1322; 
    }
    .your-details-group label {
        display: none;
    }

    /* Allergen Checkbox */
    .allergen-check {
        font-size: 14px;
        margin-bottom: 30px;
        font-family: 'Karla', sans-serif; 
    }
    .allergen-check input[type="checkbox"] {
        margin-right: 8px;
        transform: scale(1.1);
    }
    
    /* Place Order CTA Button */
    .place-order-button {
        background-color: #FFBA51;
        color: #000000;
        border: none;
        padding: 15px 52px;
        border-radius: 999px;
        font-family: 'Quicksand', sans-serif;
        font-weight: 700;
        letter-spacing: 0.12em;
        text-transform: uppercase;
        cursor: pointer;
        display: inline-block; 
        transition: background-color 0.2s;
    }
    .place-order-button:hover {
        background-color: #e5a849;
    }
    
    .cancel-note {
        font-family: 'Karla', sans-serif; 
        font-size: 12px;
        color: #A884B4; 
        margin-top: 15px;
    }

    /* --- Right Column: Summary and Illustration --- */
    .right-side-column { 
        grid-column: 2 / 3;
        display: flex;
        flex-direction: column; 
        gap: 20px; 
    }

    .order-summary-column {
        background-color: #f4e7ff; 
        padding: 25px;
        border-radius: 8px;
        height: fit-content; 
    }

    .summary-title {
        font-family: 'Quicksand', sans-serif;
        font-size: 20px;
        font-weight: 600;
        letter-spacing: 0.1em;
        text-transform: uppercase;
        margin-bottom: 20px;
        padding-bottom: 10px;
        border-bottom: 1px solid #d3b9e8;
    }
    .order-summary-column p {
        font-family: 'Karla', sans-serif; 
        font-size: 14px;
        margin-bottom: 20px;
    }

    .summary-item {
        display: flex;
        justify-content: space-between;
        font-family: 'Karla', sans-serif;
        font-size: 15px;
        margin-bottom: 10px;
    }
    .summary-item span:first-child {
        color: #444;
    }

    .summary-divider {
        border-top: 1px solid #d3b9e8;
        margin: 15px 0;
    }

    .summary-total {
        display: flex;
        justify-content: space-between;
        font-family: 'Quicksand', sans-serif; 
        font-size: 22px;
        font-weight: 700;
    }

    .order-illustration-column { 
        background-color: #f4e7ff; 
        border-radius: 8px;
        padding: 20px;
        display: flex;
        align-items: flex-start; 
        justify-content: center;
        height: fit-content; 
    }
    .order-illustration-column img {
        max-width: 100%;
        height: auto;
        display: block;
    }


.form-section {
  margin-bottom: 32px;
}

#pickup-delivery-dates .date-time-inputs {
  margin-top: 10px;
  margin-bottom: 16px;   
}

#delivery-address-fields .input-group:nth-of-type(2) {
  display: grid;
  grid-template-columns: 1fr 1fr;  /* Match Delivery Date + Delivery Time widths */
  gap: 20px;
}

#delivery-address-fields .input-group:nth-of-type(2) > div:nth-child(1) {
  order: 2; /* Moves Delivery Date to left */
}

#delivery-address-fields .input-group:nth-of-type(2) > div:nth-child(2) {
  order: 1; 
}

#delivery-address-fields .input-group:nth-of-type(2) {
  max-width: 400px;  
  margin-left: 20px;     
}

.your-details-group {
  gap: 16px;             
  margin-bottom: 16px;   
}


.allergen-check {
  margin-bottom: 20px; 
}


.form-section h3 {
  margin-bottom: 12px;
}

  </style>
</head>

<body>
  <div class="page-wrapper">

    <header class="site-header">
      <div class="header-inner content-container">

        <nav class="nav-left">
          <a href="menu.html">Menu</a>
          <a href="about.html">About</a>
        </nav>

        <div class="logo-wrapper">
          <a href="index.html">
            <img src="logo.png" alt="Julia Mooncake logo">
          </a>
        </div>

        <nav class="nav-right">
          <a href="contact.html">Contact</a>
          <a href="order.html" class="active">Order</a>
        </nav>

      </div>
    </header>

    <main>
        <div class="order-grid content-container">
            <h1 class="order-title">ORDER ONLINE</h1>
            
            <div class="order-form-column">
                <form action="#" method="POST">
                    
                    <div class="form-section">
                        <h3>CHOOSE YOUR BOX SIZE</h3>
                        <select name="box-size" class="box-size-select" id="box-size-select">
                            <option value="small" data-price="3" data-limit="1">Small ($3)</option>
                            <option value="large" data-price="6" data-limit="1">Large ($6)</option>
                            <option value="4-pack-small" data-price="12" data-limit="4">4-Pack (Small - $12)</option>
                            <option value="4-pack-large" data-price="24" data-limit="4">4-Pack (Large - $24)</option>
                        </select>
                    </div>

                    <div class="form-section">
                        <h3>SELECT YOUR FLAVOURS (up to <span id="js-flavor-limit">1</span> max)</h3>
                        <div class="flavor-options js-flavor-count-required">
                            
                            <label class="flavor-option">
                                <input type="checkbox" name="flavour" value="pandan">
                                <div class="flavor-image-wrapper">
                                    <img src="pandan.png" alt="Pandan Delight Mooncake">
                                </div>
                                <p>Pandan Delight</p>
                            </label>

                            <label class="flavor-option">
                                <input type="checkbox" name="flavour" value="red-bean">
                                <div class="flavor-image-wrapper">
                                    <img src="redbean.png" alt="Red Bean Mooncake">
                                </div>
                                <p>Red Bean</p>
                            </label>

                            <label class="flavor-option">
                                <input type="checkbox" name="flavour" value="double-yolk">
                                <div class="flavor-image-wrapper">
                                    <img src="dubyolk.png" alt="Double Yolk Mooncake">
                                </div>
                                <p>Double Yolk</p>
                            </label>

                            <label class="flavor-option">
                                <input type="checkbox" name="flavour" value="single-yolk">
                                <div class="flavor-image-wrapper">
                                    <img src="oneyolk.png" alt="Single Yolk Mooncake">
                                </div>
                                <p>Single Yolk</p>
                            </label>

                            <label class="flavor-option">
                                <input type="checkbox" name="flavour" value="mixed-nuts">
                                <div class="flavor-image-wrapper">
                                    <img src="nuts.png" alt="Mixed Nuts Mooncake">
                                </div>
                                <p>Mixed Nuts</p>
                            </label>

                            <label class="flavor-option">
                                <input type="checkbox" name="flavour" value="black-sesame">
                                <div class="flavor-image-wrapper">
                                    <img src="sesame.png" alt="Black Sesame Mooncake">
                                </div>
                                <p>Black Sesame</p>
                            </label>
                            
                        </div>
                    </div>

                    <div class="form-section">
                        <h3>NOTES (MESSAGE, SPECIAL REQUESTS...)</h3>
                        <textarea name="notes"></textarea>
                    </div>

                    <div class="form-section">
                        <h3>PICKUP OR DELIVERY</h3>
                        <div class="delivery-options">
                            <label>
                                <input type="radio" name="delivery-option" value="pickup" id="pickup-radio" checked> 
                                Pickup (Waterloo, Ontario)
                            </label>
                            <label>
                                <input type="radio" name="delivery-option" value="local-delivery" id="local-delivery-radio"> 
                                Local Delivery (within 20km)
                            </label>
                        </div>

                        <div id="pickup-delivery-dates">
                            <div class="date-time-inputs">
                                <div>
                                    <label for="pickup-date">Pickup Date</label>
                                    <input type="date" id="pickup-date" name="pickup-date">
                                </div>
                                <div>
                                    <label for="pickup-time">Pickup Time</label>
                                    <input type="time" id="pickup-time" name="pickup-time">
                                </div>
                            </div>
                        </div>

                      <div class="delivery-details" id="delivery-address-fields">

 
    <div class="input-group">
        <div>
            <label for="address" class="visually-hidden">Address</label>
            <input type="text" id="address" name="address" placeholder="Address">
        </div>
        <div>
            <label for="city" class="visually-hidden">City</label>
            <input type="text" id="city" name="city" placeholder="City">
        </div>
    </div>


    <div class="input-group">
        <div>
            <label for="postal-code" class="visually-hidden">Postal Code</label>
            <input type="text" id="postal-code" name="postal-code" placeholder="Postal Code">
        </div>
    </div>

</div>

                    </div>

                    <div class="form-section">
                        <h3>YOUR DETAILS</h3>
                        <div class="your-details-group">
                            <div>
                                <label for="name" class="visually-hidden">Name</label>
                                <input type="text" id="name" name="name" placeholder="Name" required>
                            </div>
                            <div>
                                <label for="phone" class="visually-hidden">Phone</label>
                                <input type="tel" id="phone" name="phone" placeholder="Phone">
                            </div>
                        </div>
                        <div class="your-details-group">
                            <label for="email" class="visually-hidden">Email</label>
                            <input type="email" id="email" name="email" placeholder="Email" required>
                        </div>

                        <div class="allergen-check">
                            <label>
                                <input type="checkbox" name="allergen-acknowledge" required>
                                I acknowledge allergen risks.
                            </label>
                        </div>
                    </div>

                    <button type="submit" class="place-order-button">PLACE ORDER</button>
                    
                    <p class="cancel-note">Free cancellation within 24h. We will email confirmation and pickup details.</p>
                </form>
            </div>
            
            <div class="right-side-column">
                <div class="order-summary-column">
                    <h2 class="summary-title">SUMMARY</h2>
                    <p>Order details and final cost will update automatically as you make your selections.</p>
                    
                    <div class="summary-item">
                        <span>Box Selection</span>
                        <span id="js-subtotal-box">$3.00</span> 
                    </div>
                    <div class="summary-item">
                        <span>Flavors Subtotal</span>
                        <span id="js-subtotal-flavors">$0.00</span>
                    </div>
                    <div class="summary-item">
                        <span>Delivery</span>
                        <span id="js-delivery-fee">$0.00</span>
                    </div>
                    <div class="summary-item">
                        <span>Tax (13%)</span>
                        <span id="js-tax">$0.39</span>
                    </div>
                    
                    <div class="summary-divider"></div>
                    
                    <div class="summary-total">
                        <span>Total</span>
                        <span id="js-grand-total">$3.39</span>
                    </div>
                </div>
                
                <div class="order-illustration-column">
                    <img src="tall.png" alt="Illustration of bunnies making mooncakes">
                </div>
            </div>
            
        </div>
    </main>

    <footer class="site-footer">
      <div class="footer-inner content-container">
        <div class="footer-column footer-nav">
          <h3 class="footer-heading">NAVIGATE</h3>
          <a href="menu.html">MENU</a>
          <a href="about.html">ABOUT</a>
          <a href="contact.html">CONTACT</a>
          <a href="order.html">ORDER</a>
        </div>

        <div class="footer-column footer-contact">
          <h3 class="footer-heading">VISIT & CONTACT</h3>
          <div class="footer-contact-list">
            <div class="footer-contact-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none"
                   stroke="#241728" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="3" y="5" width="18" height="14" rx="2" />
                <polyline points="3,7 12,13 21,7" />
              </svg>
              <span>JULIAMOONCAKE@GMAIL.COM</span>
            </div>
            <div class="footer-contact-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none"
                   stroke="#241728" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21 10c0 7-9 12-9 12s-9-5-9-12a9 9 0 1 1 18 0z" />
                <circle cx="12" cy="10" r="3" />
              </svg>
              <span>WATERLOO, ONTARIO</span>
            </div>
            <div class="footer-contact-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none"
                   stroke="#241728" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="12" cy="12" r="9" />
                <polyline points="12 7 12 12 15 14" />
              </svg>
              <span>MON–FRI, 10AM – 6PM</span>
            </div>
            <div class="footer-contact-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none"
                   stroke="#241728" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.8 19.8 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6A19.8 19.8 0 0 1 2.13 4.1 2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.8 12.8 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.67a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.8 12.8 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" />
              </svg>
              <span>123-456-7890</span>
            </div>
          </div>
        </div>

        <div class="footer-column footer-policy">
          <h3 class="footer-heading">POLICIES</h3>
          <a href="refund.html">REFUND POLICY</a>
          <a href="terms.html">TERMS OF SERVICE</a>
          <a href="privacy.html">PRIVACY POLICY</a>
          <a href="https://uwaterloo.ca/" target="_blank">UNIVERSITY OF WATERLOO</a>
        </div>
      </div>
    </footer>

  </div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const boxSizeSelect = document.getElementById('box-size-select');
    const flavorCheckboxes = document.querySelectorAll('.flavor-options input[type="checkbox"]');
    const flavorLimitText = document.getElementById('js-flavor-limit');
    const subtotalBoxSpan = document.getElementById('js-subtotal-box');
    const subtotalFlavorsSpan = document.getElementById('js-subtotal-flavors');
    const deliveryFeeSpan = document.getElementById('js-delivery-fee');
    const taxSpan = document.getElementById('js-tax');
    const grandTotalSpan = document.getElementById('js-grand-total');

    const pickupRadio = document.getElementById('pickup-radio');
    const localDeliveryRadio = document.getElementById('local-delivery-radio');
    const deliveryAddressFields = document.getElementById('delivery-address-fields');

    const DELIVERY_FEE = 5.00;
    const TAX_RATE = 0.13;

    function getCurrentFlavorLimit() {
      const selectedOption = boxSizeSelect.options[boxSizeSelect.selectedIndex];
      return parseInt(selectedOption.getAttribute('data-limit')) || 1;
    }

    function getCurrentBoxPrice() {
      const selectedOption = boxSizeSelect.options[boxSizeSelect.selectedIndex];
      return parseFloat(selectedOption.getAttribute('data-price')) || 0;
    }

    function calculateTotal() {
      const boxPrice = getCurrentBoxPrice();
      const flavorLimit = getCurrentFlavorLimit();

      const flavorSubtotal = 0; // included

      const isDelivery = localDeliveryRadio.checked;
      const deliveryFee = isDelivery ? DELIVERY_FEE : 0.00;

      const subtotal = boxPrice + flavorSubtotal;
      const taxableAmount = subtotal + deliveryFee;
      const taxAmount = taxableAmount * TAX_RATE;
      const grandTotal = taxableAmount + taxAmount;

      subtotalBoxSpan.textContent = `$${boxPrice.toFixed(2)}`;
      subtotalFlavorsSpan.textContent = `$${flavorSubtotal.toFixed(2)}`;
      deliveryFeeSpan.textContent = `$${deliveryFee.toFixed(2)}`;
      taxSpan.textContent = `$${taxAmount.toFixed(2)}`;
      grandTotalSpan.textContent = `$${grandTotal.toFixed(2)}`;

      flavorLimitText.textContent = flavorLimit;
    }

    function handleBoxSizeChange() {
      const flavorLimit = getCurrentFlavorLimit();
      const checked = Array.from(flavorCheckboxes).filter(cb => cb.checked);

      if (flavorLimit === 1) {
        checked.slice(1).forEach(cb => cb.checked = false);
      } else if (flavorLimit > 1 && checked.length > flavorLimit) {
        checked.slice(flavorLimit).forEach(cb => cb.checked = false);
      }

      calculateTotal();
    }

    function handleFlavorCheckboxChange(event) {
      const flavorLimit = getCurrentFlavorLimit();
      const checked = Array.from(flavorCheckboxes).filter(cb => cb.checked);

      if (flavorLimit === 1) {
        if (event.target.checked) {
          flavorCheckboxes.forEach(cb => {
            if (cb !== event.target) cb.checked = false;
          });
        }
      } else if (flavorLimit > 1) {
        if (checked.length > flavorLimit && event.target.checked) {
          event.target.checked = false;
          alert(`You can select up to ${flavorLimit} flavours for this box.`);
          return;
        }
      }

      calculateTotal();
    }

    function handleDeliveryToggle() {
      const isDelivery = localDeliveryRadio.checked;
      deliveryAddressFields.style.display = isDelivery ? 'flex' : 'none';

      const dateLabelText = isDelivery ? 'Delivery Date' : 'Pickup Date';
      const timeLabelText = isDelivery ? 'Delivery Time' : 'Pickup Time';

      document
        .querySelector('#pickup-delivery-dates label[for="pickup-date"]')
        .textContent = dateLabelText;
      document
        .querySelector('#pickup-delivery-dates label[for="pickup-time"]')
        .textContent = timeLabelText;

      calculateTotal();
    }

    boxSizeSelect.addEventListener('change', handleBoxSizeChange);
    flavorCheckboxes.forEach(checkbox => {
      checkbox.addEventListener('change', handleFlavorCheckboxChange);
    });
    pickupRadio.addEventListener('change', handleDeliveryToggle);
    localDeliveryRadio.addEventListener('change', handleDeliveryToggle);

    handleDeliveryToggle();
    calculateTotal();
  });
</script>
</body>
</html>
